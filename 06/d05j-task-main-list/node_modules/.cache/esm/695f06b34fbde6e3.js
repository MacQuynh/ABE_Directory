let pg,pgConnectionString;_4fb‍.x([["default",()=>pgClient]]);_4fb‍.w("pg",[["default",["pg"],function(v){pg=v}]]);_4fb‍.w("../config",[["pgConnectionString",["pgConnectionString"],function(v){pgConnectionString=v}]]);



               async function pgClient() {
  const pgPool = new pg.Pool({
    connectionString: pgConnectionString,
  });

  // Test the connection
  const client = await pgPool.connect();
  const tableCountResp = await client.query(
    'select count(*) from information_schema.tables where table_schema = $1;',
    ['azdev']
  );
  client.release();

  _4fb‍.g.console.log(
    'Connected to PostgreSQL | Tables count:',
    tableCountResp.rows[0].count
  );

  pgPool.on('error', (err) => {
    _4fb‍.g.console.error('Unexpected PG client error', err);
    process.exit(-1);
  });

  return {
    pgPool,
    pgClose: async () => await pgPool.end(),
  };
}
